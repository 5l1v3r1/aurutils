#!/bin/bash
readonly argv0=aur

if [[ -z $1 ]]; then
    printf >&2 -- 'usage: %s [command]\n\n' "$argv0"
    printf >&2 -- 'available commands:\n'

    for p in AUR_LIBDIR/*; do
        printf -- '%q\n' "${p##*/aur-}"
    done | column >&2

    printf >&2 -- '\navailable user commands:\n'

    compgen -c aur- | while read -r; do
        if ! [[ -f AUR_LIBDIR/$REPLY ]]; then
            printf -- '%q\n' "${REPLY#aur-}"
        fi
    done | column >&2

    exit 1
fi

readonly PATH=AUR_LIBDIR:$PATH

if type -P aur-"$1" >/dev/null; then
    exec aur-"$1" "${@:2}"
else
    printf >&2 -- '%s: %q is not an aur command\n' "$argv0" "$1"
    exit 1
fi
