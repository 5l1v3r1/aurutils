#!/bin/bash
PS4='+(${BASH_SOURCE}:${LINENO}): ${FUNCNAME[0]:+${FUNCNAME[0]}(): }'
#argv0=aurvereq

get_pkgver() {
    awk -F'[= ]' '
        /epoch/  {ep = $NF} 
        /pkgver/ {pv = $NF} 
        /pkgrel/ {pr = $NF} 
        /^$/     {exit} 

    END {
        if (ep != "") { 
            printf "%s:%s-%s\n", ep, pv, pr
        } else {
            printf "%s-%s\n", pv, pr
        }
    }'
}

gen_srcinfo() {
    if type -P mksrcinfo; then
        mksrcinfo -o /dev/stdout
    else
        makepkg --printsrcinfo
    fi
}

ver_old=$(get_pkgver < .SRCINFO)    || exit
ver_new=$(gen_srcinfo | get_pkgver) || exit

read -r ver_stdin

((!$(vercmp "$ver_old" "$ver_new"))) && ((!$(vercmp "$ver_old" "$ver_stdin")))

# vim: set et sw=4 sts=4 ft=sh:
