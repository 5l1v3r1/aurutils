.TH AURBUILD 1 2016-07-24 AURUTILS
.SH NAME
aurbuild \- build packages to a local repository

.SH SYNOPSIS
.SY aurbuild
.OP \-cs
.OP \-a queue
.OP \-d database
.OP \-p pool
.OP \-r root
.OP \--
.OP "makepkg args"
.YS

.SH DESCRIPTION
Build packages, adding the results to a local repository (usually
configured with a \fIfile:// \fRprefix \fRin \fIpacman.conf\fR).

It is assumed that build directories are located in the current
directory, and described in a text file which is taken as argument.

.SH OPTIONS
All arguments after -- are passed to \fImakepkg\fR, or
\fImakechrootpkg \fRwhen \fI-c \fRis specified.

.B \-a
.RS
A text file with directories containing a PKGBUILD.
.RE

.B \-c
.RS
Build packages with \fImakechrootpkg\fR.
.RE

.B \-d
.RS
The name of the database.
.RE

.B \-p
.RS
The pool for the built packages. The \fBpool \fRis the location where
aurbuild will put the packages after building.
.RE

.B \-r
.RS
The root for the repository where the database files will live.
.RE

.B \-s
.RS
Sign built packages and the database with gpg.
.RE

.SH NOTES
It is recommended to use a pacman cache directory (\fICacheDir\fR) as
the package pool. This avoids checksum mismatches between built
packages, and any cached versions.

When building locally (outside a container), \fIpacman -Syu \fR is run
while restricted to a local repository. This is comparable to \fImakepkg
-i\fR, but without subsequent package installation (if a package was
installed before, it is updated to the latest available version). An
interesting side-effect is that pacman considers packages inside the
official repositories "local", and warns if they are newer than any
custom counterpart.

Before building with \fImakechrootpkg\fR, the template ("root") container
is first upgraded with \fIpacman -Syu\fR. Changes to the pacman database
are \fBnot \fRpropagated to the local system; packages must be installed
and updated separately, typically through \fIpacman -Syu
<package_name>\fR.

Package conflicts inside the container must be solved manually, as
\fImakechrootpkg\fR uses \fImakepkg --confirm -s\fR internally. For
example, to replace gcc\fR with \fBgcc-multilib\fR in the container, run
\fIarch-nspawn /var/lib/aurbuild/root pacman -S gcc-multilib\fR as root.

\fImakechrootpkg\fR reads -DEST, PACKAGER and MAKEFLAGS from
/etc/makepkg.conf (and after that, ~/.makepkg.conf), on the condition
that these variables are unavailable in the environment.  Note that
variables specified on the sudo command line (such as \fIPKGDEST\fR by
\fBaurbuild\fI) are subject to sudo policy; see sudo(8) and sudoers(5).

.SH SEE ALSO
.BR pacconf (1),
.BR pacman (1),
.BR repose (1),
.BR makepkg.conf (5),
.BR pacman.conf (5),
.BR aurutils (7),
.BR makepkg (8)

.SH AUTHORS
.MT https://github.com/AladW
Alad Wenter
.ME

.\" vim: set textwidth=72:
